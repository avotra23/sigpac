<div class="card-floating mx-auto shadow-lg" style="max-width: 700px; border: 1px solid #eef2f5;">
    <div class="right-section">
        <div class="text-center mb-4">
            <h2 class="fw-bold" style="color: #072b47;">Modification des informations de l'utilisateur</h2>
            <p class="text-muted"></p>
        </div>

        <form method="POST" action="{% url 'utilisateur:modifier_utilisateur' utilisateur_a_modifier.pk %}">
            {% csrf_token %}
            
            {% if form.non_field_errors %}
                <div class="alert alert-danger">
                    {{ form.non_field_errors }}
                </div>
            {% endif %}

            <div class="row">
                {% for field in form %}
                    {% if field.name not in champs_speciaux_a_exclure and field.name != 'groups' and field.name != 'is_active' and field.name != 'is_superuser' %}
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-semibold" for="{{ field.id_for_label }}">{{ field.label }}</label>
                            {{ field }}
                            {% if field.errors %}<div class="text-danger small">{{ field.errors }}</div>{% endif %}
                        </div>
                    {% endif %}
                {% endfor %}
            </div>

            <div class="p-3 rounded-3 mb-3" style="background-color: #f8f9fa; border: 1px solid #dee2e6;">
                <h6 class="mb-3 text-uppercase fw-bold" style="font-size: 0.8rem; letter-spacing: 1px;">Permissions & RÃ´les</h6>
                <div class="mb-3">
                    <label class="form-label" for="{{ form.groups.id_for_label }}">{{ form.groups.label }}</label>
                    {{ form.groups }}
                </div>
                
                <div class="d-flex gap-4 mt-2">
                    <div class="form-check form-switch">
                        {{ form.is_active }}
                        <label class="form-check-label" for="{{ form.is_active.id_for_label }}">{{ form.is_active.label }}</label>
                    </div>
                    <div class="form-check form-switch">
                        {{ form.is_superuser }}
                        <label class="form-check-label" for="{{ form.is_superuser.id_for_label }}">{{ form.is_superuser.label }}</label>
                    </div>
                </div>
            </div>

            <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
                <a href="{% url 'utilisateur:acc_admin' mode='utilisateur' %}" class="btn btn-light px-4 border">Annuler</a>
                <button type="submit" class="btn btn-primary px-4" style="background-color: #072b47; border: none;">
                    Enregistrer les modifications
                </button>
            </div>
        </form>
    </div>
</div>

<script>
    document.querySelectorAll('input:not([type="checkbox"]), select, textarea').forEach(el => {
        if(el.tagName === 'SELECT') el.classList.add('form-select');
        else el.classList.add('form-control');
    });
    document.querySelectorAll('input[type="checkbox"]').forEach(el => {
        el.classList.add('form-check-input');
    });
</script>